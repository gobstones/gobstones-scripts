<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Home - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="API.html">API</a></li><li><a href="API.Tasks.html">Tasks</a><ul class='methods'><li data-type='method'><a href="API.Tasks.html#.build">build</a></li><li data-type='method'><a href="API.Tasks.html#.chmod">chmod</a></li><li data-type='method'><a href="API.Tasks.html#.concurrently">concurrently</a></li><li data-type='method'><a href="API.Tasks.html#.copy">copy</a></li><li data-type='method'><a href="API.Tasks.html#.dev">dev</a></li><li data-type='method'><a href="API.Tasks.html#.eslint">eslint</a></li><li data-type='method'><a href="API.Tasks.html#.getBin">getBin</a></li><li data-type='method'><a href="API.Tasks.html#.ifUnix">ifUnix</a></li><li data-type='method'><a href="API.Tasks.html#.ifWindows">ifWindows</a></li><li data-type='method'><a href="API.Tasks.html#.isMacos">isMacos</a></li><li data-type='method'><a href="API.Tasks.html#.isWindows">isWindows</a></li><li data-type='method'><a href="API.Tasks.html#.jest">jest</a></li><li data-type='method'><a href="API.Tasks.html#.ncp">ncp</a></li><li data-type='method'><a href="API.Tasks.html#.nps">nps</a></li><li data-type='method'><a href="API.Tasks.html#.prettify">prettify</a></li><li data-type='method'><a href="API.Tasks.html#.remove">remove</a></li><li data-type='method'><a href="API.Tasks.html#.rename">rename</a></li><li data-type='method'><a href="API.Tasks.html#.rename">rename</a></li><li data-type='method'><a href="API.Tasks.html#.replace">replace</a></li><li data-type='method'><a href="API.Tasks.html#.rimraf">rimraf</a></li><li data-type='method'><a href="API.Tasks.html#.rollup">rollup</a></li><li data-type='method'><a href="API.Tasks.html#.runBin">runBin</a></li><li data-type='method'><a href="API.Tasks.html#.serially">serially</a></li><li data-type='method'><a href="API.Tasks.html#.serve">serve</a></li><li data-type='method'><a href="API.Tasks.html#.start">start</a></li><li data-type='method'><a href="API.Tasks.html#.tsNode">tsNode</a></li><li data-type='method'><a href="API.Tasks.html#.tsc">tsc</a></li><li data-type='method'><a href="API.Tasks.html#.typedoc">typedoc</a></li></ul></li><li><a href="API.Validator.html">Validator</a><ul class='methods'><li data-type='method'><a href="API.Validator.html#.failIfArgumentInvalid">failIfArgumentInvalid</a></li><li data-type='method'><a href="API.Validator.html#.failIfOptionInvalid">failIfOptionInvalid</a></li><li data-type='method'><a href="API.Validator.html#.invalidValueForOption">invalidValueForOption</a></li><li data-type='method'><a href="API.Validator.html#.isValidOption">isValidOption</a></li></ul></li><li><a href="CLI.html">CLI</a></li><li><a href="CLI.Helpers.html">Helpers</a><ul class='methods'><li data-type='method'><a href="CLI.Helpers.html#.banner">banner</a></li><li data-type='method'><a href="CLI.Helpers.html#.display">display</a></li><li data-type='method'><a href="CLI.Helpers.html#.printConfiguration">printConfiguration</a></li><li data-type='method'><a href="CLI.Helpers.html#.runOrEnd">runOrEnd</a></li><li data-type='method'><a href="CLI.Helpers.html#.welcome">welcome</a></li></ul></li><li><a href="CLI.Program.html">Program</a></li><li><a href="Config.html">Config</a></li><li><a href="Config.Files.html">Files</a><ul class='methods'><li data-type='method'><a href="Config.Files.html#.loadConfigurationFiles">loadConfigurationFiles</a></li></ul></li><li><a href="Config.PackageJSONOptions.html">PackageJSONOptions</a><ul class='methods'><li data-type='method'><a href="Config.PackageJSONOptions.html#.optionsFormPackageJson">optionsFormPackageJson</a></li></ul></li><li><a href="Config.PackageManager.html">PackageManager</a><ul class='methods'><li data-type='method'><a href="Config.PackageManager.html#.getPackageManager">getPackageManager</a></li></ul></li><li><a href="Config.Paths.html">Paths</a><ul class='methods'><li data-type='method'><a href="Config.Paths.html#.getGobstonesScriptsRootPath">getGobstonesScriptsRootPath</a></li><li data-type='method'><a href="Config.Paths.html#.getProjectRootPath">getProjectRootPath</a></li></ul></li><li><a href="Config.Projects.html">Projects</a><ul class='methods'><li data-type='method'><a href="Config.Projects.html#.addOnInitEjectUpdate">addOnInitEjectUpdate</a></li><li data-type='method'><a href="Config.Projects.html#.retainKeysMatching">retainKeysMatching</a></li></ul></li><li><a href="Config.Tool.html">Tool</a></li></ul>
    
</nav>

<div id="main">
    

    



    


    <section class="package">
        <h3> </h3>		
    </section>









    



    <section class="readme usertext">
        <article><h1 id="gobstones-scripts">gobstones-scripts</h1>
<p>Gobstones Scripts is a CLI tool that helps in the creation of libraries for the Gobstones Project by hiding away the configuration files for several building tools, such as Typescript, Rollup, Webpack, Jest, nps and Typedoc. It also provides some pre-defined files for styling and linting, such as .editorconfig, prettier and ESLint support files, that are automatically copied to the root of your project during initialization.</p>
<p>You may thing of gobstones-script as some sort of create-react-app + react-scripts for the Gobstones Project libraries.</p>
<p>Configurations may be overwritten at any time to provide more functionality, but defaults tend to work on most cases.</p>
<p><a href="https://github.com/gobstones/gobstones-scripts/blob/main/LICENSE"><img src="https://img.shields.io/github/license/gobstones/gobstones-scripts?style=plastic&amp;label=License&amp;logo=open-source-initiative&amp;logoColor=white&amp;color=olivegreen" alt="Licence"></a> <a href="https://www.npmjs.com/package/@gobstones/gobstones-scripts"><img src="https://img.shields.io/github/package-json/v/gobstones/gobstones-scripts?style=plastic&amp;label=Version&amp;logo=git-lfs&amp;logoColor=white&amp;color=crimson" alt="Version"></a> <a href="https://gobstones.github.io/gobstones-scripts"><img src="https://img.shields.io/github/package-json/homepage/gobstones/gobstones-scripts?color=blue&amp;label=API%20Docs&amp;logo=gitbook&amp;logoColor=white&amp;style=plastic" alt="API Docs"></a></p>
<p><img src="https://img.shields.io/github/actions/workflow/status/gobstones/gobstones-scripts/on-commit-test.yml?style=plastic&amp;label=Tests&amp;logo=github-actions&amp;logoColor=white" alt="GitHub Workflow Tests"> <img src="https://img.shields.io/github/actions/workflow/status/gobstones/gobstones-scripts/on-commit-build.yml?style=plastic&amp;label=Build&amp;logo=github-actions&amp;logoColor=white" alt="GitHub Workflow Build"></p>
<h2 id="install">Install</h2>
<p>This library adds a binary file that can be executed as a CLI. There are two ways in which you can install gobstones-scripts, globally or locally.</p>
<h3 id="global-install">Global install</h3>
<p>The global install allows to execute the <em>gobstones-scripts</em> command globally, by installing the CLI to your path. The best thing about it
is the ability to create new projects or to initialize a project in a specific folder. To install globally with <strong>npm</strong> run</p>
<pre class="prettyprint source lang-bash"><code>npm install --global @gobstones/gobstones-scripts
</code></pre>
<p>You do not need the global installation in order to use <em>gobstones-scripts</em> in a project, but it's useful if you are starting a project from scratch.</p>
<h3 id="local-install">Local install</h3>
<p>To install locally to your already created project run the following with <strong>npm</strong>.</p>
<pre class="prettyprint source lang-bash"><code>npm install --save-dev @gobstones/gobstones-scripts
</code></pre>
<p>This will add <em>gobstones-scripts</em> as a dependency to your project.
Remember to install all peer dependencies too, as this are needed to run all tooling that <em>gobstones-scripts</em> require.</p>
<h2 id="running-through-cli">Running through CLI</h2>
<p>The common usage is to run <em>gobstones-scripts</em> as a CLI tool, by running directly in the following way if you installed globally</p>
<pre class="prettyprint source lang-bash"><code>gobstones-scripts
</code></pre>
<p>or through <strong>npx</strong> if installed locally.</p>
<pre class="prettyprint source lang-bash"><code>npx gobstones-scripts
</code></pre>
<p>If you have created a project through this tool, you already have a script in your <code>package.json</code> file to run the tool, <code>gbs</code>. Just run the script via your package manager:</p>
<pre class="prettyprint source lang-bash"><code>npm run gbs
</code></pre>
<p>Run the command always from the root of your project in order to execute local commands.</p>
<h3 id="cli-usage">CLI usage</h3>
<p>The CLI provides you with the following commands:</p>
<ul>
<li><strong>help</strong>: Prints the tool help description. Also, the help is printed if no command is given</li>
<li><strong>version</strong>: Prints the tool version information.</li>
<li><strong>config</strong>: Prints the tool's configuration, such as, what is the identified root folder, the package folder and the files in use.</li>
<li><strong>create <projectName></strong>: Create a new library project in a subfolder with the given name. This includes creating all the required and recommended style files, define a package.json, git configuration files, visual studio code files, NPM configuration files, contribution guidelines, a readme, a license (MIT by default), install all dependencies, and initialize a git repository. This command is expected to be used when <em>gobstones-scripts</em> is installed globally.</li>
<li><strong>init</strong>: The same as create, but runs on the local folder as a project. That is, initialize a project in the current folder. Note that the folder must be empty in order to initialize a project in the folder. This command is expected to be used when <em>gobstones-scripts</em> is installed globally.</li>
<li><strong>update [force]</strong>: Override the missing configuration files that are created on an <strong>init</strong> or <strong>create</strong> command on the local project. This is intended to be run locally, on an already created project, to update the configuration. By appending <strong>force</strong> as a subcommand, all files are updated to their latest version.</li>
<li><strong>eject [force]</strong>: Eject all the general configuration files to the root project. This includes configuration files for Typescript, Typedoc, JEST, Rollup, and nps. This command is intended to be run locally. If <strong>force</strong> is added, all previously created local files are updated to their latest version. If not, only missing files are copied.</li>
<li><strong>run [command]</strong>: Run a command using <strong>nps</strong>. nps allows to run different scripts configured, such as scripts for linting, prettyfing, testing, generating documentation, running in development mode, and others.</li>
</ul>
<h2 id="how-to-configure-the-tool">How to configure the tool</h2>
<p>When running a command using <em>gobstones-scripts</em> the tool loads all configuration from one of two locations.</p>
<ul>
<li>If a configuration file for a tool is present at the root of your project, that configuration is used. As an example, if you have a <code>rollup.config.js</code> file in the root of your project, then that file is used to load the Rollup configuration.</li>
<li>If a configuration file for a tool is not present at the root of your project, then the default configuration file from gobstones-scripts is used. This configuration files are at <code>./node_modules/@gobstones/gobstones-scripts/config</code>, and they should not be modified by the end user. If you need changes over a default configuration, you should eject that configuration file to the root of your project.</li>
</ul>
<blockquote>
<p>A special mention is required for the typescript configuration file, <strong>tsconfig.json</strong>. You will see that this file is actually not present. We use <strong>tsconfig.js</strong> instead, and the corresponding JSON file is generated at runtime when running a command through gobstones-scripts. Using a js file for configuration provides the required flexibility for this project, that is not found in the JSON file, but a JSON file needs to be generated before running the Typescript compiler, as Typescript does not support javascript based configuration. Note that this is all handled automatically by gobstones-scripts, and you just need to remember to edit a tsconfig.js instead of json one if you need to override the default configuration.</p>
</blockquote>
<h2 id="running-commands-using-gobstones-scripts">Running commands using gobstones-scripts</h2>
<p>Command are run using <strong>nps</strong>. By default, the available command that you can run are located in the default <code>package-scripts.js</code> file at the package configuration folder, although you may override it with your own.
If you have created a project from scratch with <em>gobstones-scripts</em> then you can run command by just calling:</p>
<pre class="prettyprint source lang-bash"><code>npm start &lt;command>
</code></pre>
<p>The default command (no command provided) prints all the available commands and help. So in example, if you want to run the tests, you may run:</p>
<pre class="prettyprint source lang-bash"><code>npm start test
</code></pre>
<p>Or if you want to run the linter:</p>
<pre class="prettyprint source lang-bash"><code>npm start lint
</code></pre>
<p>On a newly created project, there are also some additional scripts in your package json that are useful when building and automating, but that can be quite handy when running, such as <code>test</code> or <code>build</code>, so you can run directly by:</p>
<pre class="prettyprint source lang-bash"><code>npm test
</code></pre>
<p>or</p>
<pre class="prettyprint source lang-bash"><code>npm run build
</code></pre>
<p>You may add additional nps commands by overriding the tools <code>package-scripts.js</code> file. But there are a few gotchas.</p>
<h3 id="gotchas-of-overriding-nps-configuration">Gotchas of overriding nps configuration</h3>
<p>When running using <em>gobstones-scripts</em> the configuration files for the building and running tools, such as Typescript compiler configuration, may live in your projects root or be default's, that live in the <em>gobstones-script</em> configuration folder in <code>node_modules</code>. The tool first checks what configuration files are to be used, and then calls the appropriate commands with that configuration file as an option. So it's not just as easy as calling <code>jest</code> or <code>rollup</code>, as an argument to indicate which configuration file is going to be used needs to be included.</p>
<p>The default <code>package-scripts.js</code> handles this by importing <code>tools</code> from the <em>gobstones-scripts</em> source (see usage as a module for more information), and calling some functions that the tooling provide. Some functions include i.e. the <code>jest</code> or the <code>rollup</code> function, that call the underlying tool with the appropriate configuration file as an argument. This is achieved by using the configuration that the API exposes.</p>
<h2 id="api">API</h2>
<p>You can access the API by importing the module</p>
<pre class="prettyprint source lang-ts"><code>import gobstones_scripts from '@gobstones/gobstones-scripts';
</code></pre>
<p>Typings are exported so it can be used in TypeScript without additional packages.</p>
<p>The API exposes the <code>create</code>, <code>init</code>, <code>update</code>, <code>eject</code> and <code>run</code> functions that are explained in the CLI. It also provides access to the version and the configuration through the <code>version</code> and <code>config</code> attributes.</p>
<p>Additionally, it provides a ser of functions that are useful for extending the <code>package-scripts.js</code> with custom actions, without having to worry about calling the tooling system with the corresponding configuration files. This are exposed at the <code>tools</code> object. The <code>tools</code> object provides functions such as <code>jest</code>, <code>rollup</code>, <code>tsc</code> and other handy actions such as <code>rename</code>, <code>concurrently</code> and <code>series</code>, that act as expected.</p>
<p>You may read their documentation in the source code.</p>
<h2 id="usage-with-other-package-managers">Usage with other package managers</h2>
<p>By default <em>gobstones-scripts</em> it's intended to be used by <strong>npm</strong>
as the package manager, which is included by default on your node
installation.</p>
<p>Nonetheless, <em>gobstones-scripts</em> has been tested to work with
<strong>yarn</strong> too. <em>gobstones-scripts</em> relies on a flat <em>node_modules</em>,
in order to hide away packages, so <strong>pnpm</strong> will not work with this
tool.</p>
<p>Some internal commands relay on calling <strong>npm install</strong> or <strong>npx</strong>,
which are replace to their counterparts in other package managers if
<em>gobstones-scripts</em> is called through them.</p>
<p>To detect which package manager has been used, we relay on
<code>npm_config_user_agent</code> environment variable, which is populated when
executing through a package manager.</p>
<p>So if you run, i.e. <code>yarn start</code> instead of <code>npm start</code> the tool detects <strong>yarn</strong> as your package manager, and replaces all internal usages of <strong>npm install</strong> to <strong>yarn install</strong>.</p>
<p>By default, <strong>npm</strong> is used, although you can configure this by the
<strong>gobstones-scripts</strong> key in your <strong>package.json</strong>.</p>
<p>Support may change in the future once <a href="corepack">https://nodejs.org/dist/latest/docs/api/corepack.html</a> gets out of the experimental state.</p>
<h2 id="underlying-technologies">Underlying technologies</h2>
<p>The underlying technologies in use include</p>
<ul>
<li><strong>typescript</strong> (tsc for building)</li>
<li><strong>rollup</strong> (for bundling libraries and cli-libraries)</li>
<li><strong>vite</strong> (for bundling web-libraries and react-libraries)</li>
<li><strong>eslint</strong> (for linting)</li>
<li><strong>prettier</strong> (for styling)</li>
<li><strong>typedoc</strong> (for documentation generation)</li>
<li><strong>storybook</strong> (for testing and documenting react-libraries)</li>
<li><strong>nps</strong> (for orchestrating the tooling)</li>
<li><strong>husky</strong> (for hooking into git actions)</li>
</ul>
<p>Other files copied to your project will include</p>
<ul>
<li><strong>.editorconfig</strong> (for editor styling, matching prettier)</li>
<li><strong>.gitignore</strong> (for git management)</li>
<li><strong>.npmignore</strong> (for publishing configuration)</li>
</ul>
<p>Also a <strong>.github</strong> folder will configure GitHub actions, and a <strong>.vscode</strong> folder will configure your Visual Studio Code environment on first run.</p>
<p>Finally, other files included do not require special technologies, but are important, such as <strong>CHANGELOG.md</strong>, <strong>CONTRIBUTING.md</strong>, <strong>README.md</strong> and LICENSE, together with <strong>package.json</strong>.</p>
<h2 id="updating-the-version-while-coding-the-tool">Updating the version while coding the tool</h2>
<p>The tool has a more complex system for updating the version than other libraries, as not only the package.json needs to be changed.
As the version needs to be updated in multiple places of the tool for this to work, an <code>update-version.js</code> script exists that does the job. This tool need to be called in the following way:</p>
<pre class="prettyprint source lang-sh"><code>node update-version.js &lt;version>
</code></pre>
<p>Where <code>&lt;version&gt;</code> is a specific version using major, minor and patch system. After calling the tool, the version will be updated everywhere for the tool.</p>
<h2 id="testing-newer-versions-of-the-library">Testing newer versions of the library</h2>
<p>This tool relies heavily on the packaging system. In that sense, the library need to be published in order to be tested, which constitutes a problem, as it cannot be tested without publishing. For that, we make use of <a href="http://verdaccio.org">verdaccio</a>. Verdaccio provides a private server, which can run locally. By running verdaccio locally, then the newer versions of the library can be tested using such server instead of having to publish to npm.</p>
<p>Firs, publish the script globally using <code>npm link</code>, so you have an easy way of calling the tool.</p>
<p>You can then run the verdaccio server and publish the library to it by running</p>
<pre class="prettyprint source lang-sh"><code>npm start verdaccio
</code></pre>
<p>Also, the following command performs the same:</p>
<pre class="prettyprint source lang-sh"><code>npm run build
</code></pre>
<p>While, on the other hand, <code>npm test</code> performs the same after running the linter.</p>
<p>While the server is still running, you can run the globally installed script, adding the testing flag to any command (<code>--test</code> or <code>-T</code>). This flag instructs the tool to search the library in the verdaccio server instead of npmjs registry.</p>
<p>Additionally, it may happen that you are required to configure verdaccio locally. In such case, run the following command:</p>
<pre class="prettyprint source lang-sh"><code>npm start verdaccio.serve
</code></pre>
<p>This will run the verdaccio server, but it will not attempt to publish the library. You should then configure the user and publish the library manually. First create a user in the server by running:</p>
<pre class="prettyprint source lang-sh"><code>npm adduser --registry http://localhost:4567
</code></pre>
<p>Then login to the registry:</p>
<pre class="prettyprint source lang-sh"><code>npm login --registry http://localhost:4567
</code></pre>
<p>After that, you should be able to publish your library by doing:</p>
<pre class="prettyprint source lang-sh"><code>npm publish --registry http://localhost:4567
</code></pre>
<p>Once the verdaccio server is configured for the first time, you should be able to stop it and the re-run and publish using the <code>npm start verdaccio</code> command.</p>
<h2 id="contributing">Contributing</h2>
<p>See the <a href="https://github.com/gobstones/gobstones-guidelines">Gobstones Platform Contributions Guidelines</a> to contribute.</p></article>
    </section>






    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Thu Oct 12 2023 17:52:56 GMT-0300 (hora est√°ndar de Argentina) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>